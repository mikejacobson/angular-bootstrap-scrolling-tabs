/**
 * angular-bootstrap-scrolling-tabs
 * @version v0.1.1
 * @link https://github.com/mikejacobson/angular-bootstrap-scrolling-tabs
 * @author Mike Jacobson <michaeljjacobson1@gmail.com>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
(function(b){var d={CONTINUOUS_SCROLLING_TIMEOUT_INTERVAL:50,SCROLL_OFFSET_FRACTION:6,DATA_KEY_IS_MOUSEDOWN:"ismousedown"},f=angular.module("mj.scrollingTabs",[]),e=['<div class="scrtabs-tab-container">',' <div class="scrtabs-tab-scroll-arrow scrtabs-js-tab-scroll-arrow-left"><span class="glyphicon glyphicon-chevron-left"></span></div>','   <div class="scrtabs-tabs-fixed-container">','     <div class="scrtabs-tabs-movable-container">','       <ul class="nav nav-tabs" role="tablist">',"         <li ng-class=\"{ 'active': tab[propActive || 'active'], ","                         'disabled': tab[propDisabled || 'disabled'] }\" ",'             data-tab="{{tab}}" data-index="{{$index}}" ng-repeat="tab in tabsArr">',"           <a ng-href=\"{{'#' + tab[propPaneId || 'paneId']}}\" role=\"tab\"","                data-toggle=\"{{tab[propDisabled || 'disabled'] ? '' : 'tab'}}\" ","                ng-bind-html=\"sanitize(tab[propTitle || 'title']);\">","           </a>","         </li>","       </ul>","     </div>"," </div>",' <div class="scrtabs-tab-scroll-arrow scrtabs-js-tab-scroll-arrow-right"><span class="glyphicon glyphicon-chevron-right"></span></div>',"</div>"].join(""),a=['<div class="scrtabs-tab-wrapper-container" ng-class="{ \'force-height\': !scrtc.hasTabContentOutsideMovableContainer }">',' <div class="scrtabs-tab-scroll-arrow scrtabs-js-tab-scroll-arrow-left"><span class="glyphicon glyphicon-chevron-left"></span></div>','   <div class="scrtabs-tabs-fixed-container">','     <div class="scrtabs-tabs-movable-container" ng-transclude></div>',"   </div>",' <div class="scrtabs-tab-scroll-arrow scrtabs-js-tab-scroll-arrow-right"><span class="glyphicon glyphicon-chevron-right"></span></div>',"</div>"].join("");(function(n,m){var l=function(r,o,p){var s;return function q(){var v=this,u=arguments;function t(){if(!p){r.apply(v,u)}s=null}if(s){clearTimeout(s)}else{if(p){r.apply(v,u)}}s=setTimeout(t,o||100)}};jQuery.fn[m]=function(o){return o?this.bind("resize.scrtabs",l(o)):this.trigger(m)}})(jQuery,"smartresize");function j(m){var l=this;l.stc=m}(function(l){l.handleClickOnLeftScrollArrow=function(o){var n=this,m=n.stc;m.scrollMovement.incrementScrollLeft()};l.handleClickOnRightScrollArrow=function(p){var n=this,m=n.stc,o=m.scrollMovement;o.incrementScrollRight(o.getMinPos())};l.handleMousedownOnLeftScrollArrow=function(o){var n=this,m=n.stc;m.scrollMovement.startScrollLeft()};l.handleMousedownOnRightScrollArrow=function(o){var n=this,m=n.stc;m.scrollMovement.startScrollRight()};l.handleMouseupOnLeftScrollArrow=function(o){var n=this,m=n.stc;m.scrollMovement.stopScrollLeft()};l.handleMouseupOnRightScrollArrow=function(o){var n=this,m=n.stc;m.scrollMovement.stopScrollRight()};l.handleWindowResize=function(p){var n=this,m=n.stc,o=m.$win.width();if(o===m.winWidth){return false}m.winWidth=o;m.elementsHandler.refreshAllElementSizes()}}(j.prototype));function c(m){var l=this;l.stc=m}(function(l){l.initElements=function(p){var n=this,o=n.stc,m=o.$tabsContainer;n.setElementReferences();if(p.isWrappingAngularUITabset){n.moveTabContentOutsideScrollContainer(p)}n.setEventListeners()};l.moveTabContentOutsideScrollContainer=function(r){var p=this,q=p.stc,o=q.$tabsContainer,n="scrtabs-tab-content-clone",m=o.find(".scrtabs-tabs-movable-container .tab-content"),s,t;if(!r.isWatchingTabs){m.show().appendTo(o);return}t=m.clone().addClass(n);s=o.find("."+n);if(s.length){s.replaceWith(t)}else{o.append(t)}};l.refreshAllElementSizes=function(){var m=this,p=m.stc,o=p.scrollMovement,q=p.scrollArrowsVisible,r={didScrollToActiveTab:false},n;m.setElementWidths();m.setScrollArrowVisibility();if(p.scrollArrowsVisible){m.setFixedContainerWidthForJustVisibleScrollArrows()}if(p.scrollArrowsVisible||q){if(p.scrollArrowsVisible){n=o.getMinPos();if(p.movableContainerLeftPos<n){o.incrementScrollRight(n)}else{o.scrollToActiveTab({isOnWindowResize:true});r.didScrollToActiveTab=true}}else{p.movableContainerLeftPos=0;o.slideMovableContainerToLeftPos()}}return r};l.removeTranscludedTabContentOutsideMovableContainer=function(){var n=this,o=n.stc,m=o.$tabsContainer;m.find(".scrtabs-tab-content-outside-movable-container").remove()};l.setElementReferences=function(){var n=this,o=n.stc,m=o.$tabsContainer;o.isNavPills=false;o.$fixedContainer=m.find(".scrtabs-tabs-fixed-container");o.$movableContainer=m.find(".scrtabs-tabs-movable-container");o.$tabsUl=o.$movableContainer.find(".nav-tabs");if(!o.$tabsUl.length){o.$tabsUl=o.$movableContainer.find(".nav-pills");if(o.$tabsUl.length){o.isNavPills=true}}o.$tabsLiCollection=o.$tabsUl.find("> li");o.$leftScrollArrow=m.find(".scrtabs-js-tab-scroll-arrow-left");o.$rightScrollArrow=m.find(".scrtabs-js-tab-scroll-arrow-right");o.$scrollArrows=o.$leftScrollArrow.add(o.$rightScrollArrow);o.$win=b(window)};l.setElementWidths=function(){var m=this,n=m.stc;if(!n.$win){return}n.containerWidth=n.$tabsContainer.outerWidth();n.winWidth=n.$win.width();n.scrollArrowsCombinedWidth=n.$leftScrollArrow.outerWidth()+n.$rightScrollArrow.outerWidth();
m.setFixedContainerWidth();m.setMovableContainerWidth()};l.setEventListeners=function(){var m=this,o=m.stc,n=o.eventHandlers;o.$leftScrollArrow.off(".scrtabs").on({"mousedown.scrtabs touchstart.scrtabs":function(p){n.handleMousedownOnLeftScrollArrow.call(n,p)},"mouseup.scrtabs touchend.scrtabs":function(p){n.handleMouseupOnLeftScrollArrow.call(n,p)},"click.scrtabs":function(p){n.handleClickOnLeftScrollArrow.call(n,p)}});o.$rightScrollArrow.off(".scrtabs").on({"mousedown.scrtabs touchstart.scrtabs":function(p){n.handleMousedownOnRightScrollArrow.call(n,p)},"mouseup.scrtabs touchend.scrtabs":function(p){n.handleMouseupOnRightScrollArrow.call(n,p)},"click.scrtabs":function(p){n.handleClickOnRightScrollArrow.call(n,p)}});o.$win.off(".scrtabs").smartresize(function(p){n.handleWindowResize.call(n,p)})};l.setFixedContainerWidth=function(){var m=this,n=m.stc,o=n.$tabsContainer.get(0).getBoundingClientRect();n.fixedContainerWidth=o.width||(o.right-o.left);n.$fixedContainer.width(n.fixedContainerWidth)};l.setFixedContainerWidthForJustHiddenScrollArrows=function(){var m=this,n=m.stc;n.$fixedContainer.width(n.fixedContainerWidth)};l.setFixedContainerWidthForJustVisibleScrollArrows=function(){var m=this,n=m.stc;n.$fixedContainer.width(n.fixedContainerWidth-n.scrollArrowsCombinedWidth)};l.setMovableContainerWidth=function(){var m=this,o=m.stc,n=o.$tabsUl.find("li"),r=o.$fixedContainer.height(),p=10;o.movableContainerWidth=0;if(n.length){n.each(function q(){var t=b(this),s=0;if(o.isNavPills){s=parseInt(t.css("margin-left"),10)+parseInt(t.css("margin-right"),10)}o.movableContainerWidth+=(t.outerWidth()+s)});o.movableContainerWidth+=1;if(o.movableContainerWidth<o.fixedContainerWidth){o.movableContainerWidth=o.fixedContainerWidth}}o.$movableContainer.width(o.movableContainerWidth);while((o.$movableContainer.height()>r)&&p--){o.$movableContainer.width(o.movableContainerWidth+=1)}};l.setScrollArrowVisibility=function(){var m=this,n=m.stc,o=n.movableContainerWidth>n.fixedContainerWidth;if(o&&!n.scrollArrowsVisible){n.$scrollArrows.show();n.scrollArrowsVisible=true;m.setFixedContainerWidthForJustVisibleScrollArrows()}else{if(!o&&n.scrollArrowsVisible){n.$scrollArrows.hide();n.scrollArrowsVisible=false;m.setFixedContainerWidthForJustHiddenScrollArrows()}}}}(c.prototype));function i(m){var l=this;l.stc=m}(function(l){l.continueScrollLeft=function(){var n=this,m=n.stc;m.$timeout(function(){if(m.$leftScrollArrow.data(d.DATA_KEY_IS_MOUSEDOWN)&&(m.movableContainerLeftPos<0)){if(!n.incrementScrollLeft()){n.continueScrollLeft()}}},d.CONTINUOUS_SCROLLING_TIMEOUT_INTERVAL)};l.continueScrollRight=function(m){var o=this,n=o.stc;n.$timeout(function(){if(n.$rightScrollArrow.data(d.DATA_KEY_IS_MOUSEDOWN)&&(n.movableContainerLeftPos>m)){if(!o.incrementScrollRight(m)){o.continueScrollRight(m)}}},d.CONTINUOUS_SCROLLING_TIMEOUT_INTERVAL)};l.decrementMovableContainerLeftPos=function(m){var o=this,n=o.stc;n.movableContainerLeftPos-=(n.fixedContainerWidth/d.SCROLL_OFFSET_FRACTION);if(n.movableContainerLeftPos<m){n.movableContainerLeftPos=m}else{if(n.scrollToTabEdge){o.setMovableContainerLeftPosToTabEdge("right");if(n.movableContainerLeftPos<m){n.movableContainerLeftPos=m}}}};l.getMinPos=function(){var n=this,m=n.stc;return m.scrollArrowsVisible?(m.fixedContainerWidth-m.movableContainerWidth-m.scrollArrowsCombinedWidth):0};l.getMovableContainerCssLeftVal=function(){var n=this,m=n.stc;return(m.movableContainerLeftPos===0)?"0":m.movableContainerLeftPos+"px"};l.incrementScrollLeft=function(){var n=this,m=n.stc;m.movableContainerLeftPos+=(m.fixedContainerWidth/d.SCROLL_OFFSET_FRACTION);if(m.movableContainerLeftPos>0){m.movableContainerLeftPos=0}else{if(m.scrollToTabEdge){n.setMovableContainerLeftPosToTabEdge("left");if(m.movableContainerLeftPos>0){m.movableContainerLeftPos=0}}}n.slideMovableContainerToLeftPos();return(m.movableContainerLeftPos===0)};l.incrementScrollRight=function(m){var o=this,n=o.stc;o.decrementMovableContainerLeftPos(m);o.slideMovableContainerToLeftPos();return(n.movableContainerLeftPos===m)};l.scrollToActiveTab=function(y){var x=this,p=x.stc,r=0,u,t,w,v,m,o,n,s,q;if(!p.scrollArrowsVisible){return}u=p.$tabsUl.find("li.active");if(!u.length){return}w=u.offset().left;t=u.outerWidth();v=w+t;m=p.$rightScrollArrow.offset().left;o=p.$leftScrollArrow.outerWidth();n=o;s=m;if(w<n){r=w-n;p.movableContainerLeftPos=p.movableContainerLeftPos-r}else{if(v>s){r=v-s;p.movableContainerLeftPos=p.movableContainerLeftPos-r}}if(r){q=x.getMinPos();if(p.movableContainerLeftPos<q){p.movableContainerLeftPos=q}else{if(p.movableContainerLeftPos>0){p.movableContainerLeftPos=0}}x.slideMovableContainerToLeftPos()}};l.setMovableContainerLeftPosToTabEdge=function(q){var n=this,m=n.stc,p=-m.movableContainerLeftPos,o=0;m.$tabsLiCollection.each(function(s){var r=b(this).width();o+=r;if(o>p){m.movableContainerLeftPos=(q==="left")?-(o-r):-o;return false}})};l.slideMovableContainerToLeftPos=function(){var n=this,m=n.stc,o;m.movableContainerLeftPos=m.movableContainerLeftPos/1;
o=n.getMovableContainerCssLeftVal();m.$movableContainer.stop().animate({left:o},"slow",function p(){var q=n.getMinPos();if(m.movableContainerLeftPos<q){n.decrementMovableContainerLeftPos(q);m.$movableContainer.stop().animate({left:n.getMovableContainerCssLeftVal()},"fast")}})};l.startScrollLeft=function(){var n=this,m=n.stc;m.$leftScrollArrow.data(d.DATA_KEY_IS_MOUSEDOWN,true);n.continueScrollLeft()};l.startScrollRight=function(){var n=this,m=n.stc;m.$rightScrollArrow.data(d.DATA_KEY_IS_MOUSEDOWN,true);n.continueScrollRight(n.getMinPos())};l.stopScrollLeft=function(){var n=this,m=n.stc;m.$leftScrollArrow.data(d.DATA_KEY_IS_MOUSEDOWN,false)};l.stopScrollRight=function(){var n=this,m=n.stc;m.$rightScrollArrow.data(d.DATA_KEY_IS_MOUSEDOWN,false)}}(i.prototype));function k(l,n){var m=this;m.$tabsContainer=l;m.$timeout=n;m.movableContainerLeftPos=0;m.scrollArrowsVisible=false;m.scrollToTabEdge=false;m.scrollMovement=new i(m);m.eventHandlers=new j(m);m.elementsHandler=new c(m)}(function(l){l.handleTriggeredRefresh=function(){var n=this,p=n.scrollMovement,o=n.elementsHandler.refreshAllElementSizes(true);if(!o.didScrollToActiveTab){n.$timeout(function m(){p.scrollToActiveTab({isOnTabsRefresh:true})},100)}};l.initTabs=function(n){var m=this,q=m.elementsHandler,p=m.scrollMovement;if(n.scrollToTabEdge){m.scrollToTabEdge=true}m.$timeout(function o(){var r;q.initElements(n);r=q.refreshAllElementSizes();if(!r.didScrollToActiveTab){p.scrollToActiveTab({isOnTabsRefresh:n.isWatchingTabs})}},100)};l.removeTranscludedTabContentOutsideMovableContainer=function(){var m=this,n=m.elementsHandler;n.removeTranscludedTabContentOutsideMovableContainer()}}(k.prototype));function h(m,l){function n(o){return l.trustAsHtml(o)}return{restrict:"E",template:e,transclude:false,replace:true,scope:{tabs:"@",watchTabs:"=",propPaneId:"@",propTitle:"@",propActive:"@",propDisabled:"@",localTabClick:"&tabClick",refreshOn:"="},link:function(r,q,p){var o=new k(q,m),s=p.scrollToTabEdge&&p.scrollToTabEdge.toLowerCase()==="true";r.tabsArr=r.$eval(r.tabs);r.propPaneId=r.propPaneId||"paneId";r.propTitle=r.propTitle||"title";r.propActive=r.propActive||"active";r.propDisabled=r.propDisabled||"disabled";r.sanitize=n;q.on("click.scrollingTabs",".nav-tabs > li",function t(v){var u=b(this).data();r.localTabClick({$event:v,$index:u.index,tab:u.tab})});if(p.refreshOn){r.$watch("refreshOn",function(v,u){if(v&&v!==u){o.handleTriggeredRefresh()}})}if(!p.watchTabs){o.initTabs({isWrapperDirective:false,scrollToTabEdge:s});return}r.$watch("watchTabs",function(y,v){var x,u;r.tabsArr=r.$eval(r.tabs);if(y.length&&y[y.length-1].active){m(function(){q.find("ul.nav-tabs > li:last").removeClass("active").find('a[role="tab"]').click()},0)}else{x=q.find(".nav-tabs > li.active");if(x.length){u=x.data("index");r.tabsArr.some(function w(z){if(z[r.propActive]){z[r.propActive]=false;return true}});r.tabsArr[u][r.propActive]=true}}o.initTabs({isWrapperDirective:false,isWatchingTabs:true,scrollToTabEdge:s})},true)}}}function g(l){return{restrict:"A",template:a,transclude:true,replace:true,link:function(u,p,s){var n=new k(p,l),r=p.find("uib-tabset").length>0,m=r||p.find("tabset, .scrtabs-tabs-movable-container div > ul.nav").length>0,t=s.scrollToTabEdge&&s.scrollToTabEdge.toLowerCase()==="true",o={hasTabContentOutsideMovableContainer:true};angular.extend(u,{scrtc:o});if(s.refreshOn){u.$watch(s.refreshOn,function(x,w){if(x&&x!==w){n.handleTriggeredRefresh()}})}if(!m){n.removeTranscludedTabContentOutsideMovableContainer();o.hasTabContentOutsideMovableContainer=false}if(!r&&!s.watchTabs){n.initTabs({isWrapperDirective:true,isWrappingAngularUITabset:m,scrollToTabEdge:t});return}if(r||(s.watchTabs&&s.watchTabs.toLowerCase()==="true")){if(m){n.removeTranscludedTabContentOutsideMovableContainer();o.hasTabContentOutsideMovableContainer=false}q();l(v,10);if(!r||!s.watchTabs||s.watchTabs.toLowerCase()==="true"){return}}u.$watch(s.watchTabs,function(x,w){if(!m){if(x.length&&x[x.length-1].active){l(function(){p.find("ul.nav-tabs > li:last").removeClass("active").find('a[role="tab"]').click()},0)}}else{if(r){if(x.length&&x[x.length-1].active){l(function(){p.find(".scrtabs-tabs-movable-container ul.nav-tabs > li:last").find('a[role="tab"],a.nav-link').click()},0)}}}q()},true);function q(w){n.initTabs({isWrapperDirective:true,isWrappingAngularUITabset:m,isWatchingTabs:true,scrollToTabEdge:t,isWatchingDom:w&&w.isWatchingDom})}function v(){var z=p.find("ul.nav-tabs"),y,w;if(!z.length){return}u.$watch(function(){return z[0].childNodes.length},function(B,A){if(B!==A){q({isWatchingDom:true})}});u.$watch(function(){l(x,0,false);return z.find("li.active").index()},angular.noop);function x(){y=z.find("li.active").index();if(y!==w){w=y;q({isWatchingDom:true})}return false}}}}}h.$inject=["$timeout","$sce"];g.$inject=["$timeout"];f.directive("scrollingTabs",h);f.directive("scrollingTabsWrapper",g)}(jQuery));
